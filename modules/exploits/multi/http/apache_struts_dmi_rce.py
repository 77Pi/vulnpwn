#!/usr/bin/python2
# -*- coding: utf-8 -*-

##
# Current source: https://github.com/open-security/Open-Security-Framework/
##

from lib.core import module


class Module(module.Module):

    meta = {
        'name': 'Apache Struts S2_032 Remote Code Execution',
        'author': 'Open-Security',
        'description': '',
        'comments': '',
        'references': [],
        'license': '',
        'options': {
            'RHOST': ['www.example.com', None, 'the target host'],
            'RPORT': [80, None, 'the target port'],
            'TARGETURI': ['/index.action', None, 'target uri to request']
        }
    }

    def __init__(self):
        module.Module.__init__(self)

    def main(self, *args, **kwargs):
        """custom main func for special task"""
        self.output('Apache Struts s2_032 Remote Code Execution')
        self.output('%s:%s%s' % (self.options['RHOST']['value'],
                                 self.options['RPORT']['value'],
                                 self.options['TARGETURI']['value']))
